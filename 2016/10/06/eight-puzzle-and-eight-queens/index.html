<!doctype html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.1.0" />






<meta name="description" content="Generate a large number of 8-puzzle and 8-queens instances and solve them(where possible) by hill climbing (steepest-ascent and first-choice variants), hill climbing with random restart, and simulated">
<meta property="og:type" content="article">
<meta property="og:title" content="八皇后和八数码问题">
<meta property="og:url" content="http://yoursite.com/2016/10/06/eight-puzzle-and-eight-queens/index.html">
<meta property="og:site_name" content="HYPJUDY">
<meta property="og:description" content="Generate a large number of 8-puzzle and 8-queens instances and solve them(where possible) by hill climbing (steepest-ascent and first-choice variants), hill climbing with random restart, and simulated">
<meta property="og:image" content="http://yoursite.com/images/8q_solved.png">
<meta property="og:image" content="http://yoursite.com/images/5q_example.png">
<meta property="og:image" content="http://yoursite.com/images/5q_example_numbered.png">
<meta property="og:image" content="http://yoursite.com/images/8q_time.png">
<meta property="og:image" content="http://yoursite.com/images/8q_solvedrate.png">
<meta property="og:image" content="http://yoursite.com/images/8d_solved.png">
<meta property="og:image" content="http://yoursite.com/images/8d_time.png">
<meta property="og:image" content="http://yoursite.com/images/8d_solvedrate.png">
<meta property="og:updated_time" content="2017-03-06T06:09:10.982Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="八皇后和八数码问题">
<meta name="twitter:description" content="Generate a large number of 8-puzzle and 8-queens instances and solve them(where possible) by hill climbing (steepest-ascent and first-choice variants), hill climbing with random restart, and simulated">
<meta name="twitter:image" content="http://yoursite.com/images/8q_solved.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2016/10/06/eight-puzzle-and-eight-queens/"/>





  <title> 八皇后和八数码问题 | HYPJUDY </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-96132499-1', 'auto');
  ga('send', 'pageview');
</script>











  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">HYPJUDY</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">What I cannot create, I do not understand.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/06/eight-puzzle-and-eight-queens/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HYPJUDY">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HYPJUDY">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                八皇后和八数码问题
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-06T16:57:09+08:00">
                2016-10-06
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/10/06/eight-puzzle-and-eight-queens/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/10/06/eight-puzzle-and-eight-queens/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Generate a large number of 8-puzzle and 8-queens instances and solve them(where possible) by hill climbing (steepest-ascent and first-choice variants), hill climbing with random restart, and simulated annealing. Measure the search cost and percentage of solved problems and graph these against the optimal solution cost. Comment on your results.<br><a id="more"></a></p>
<h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>生成大量的八数码问题和八皇后问题并用以下算法分别求解：爬山法（最陡上升和首选爬山法），随机重启爬山法，模拟退火算法。计算搜索耗散和问题的解决率，并用图对比它们的最优解代价的曲线。对结果进行评估。</p>
<p><a href="https://github.com/HYPJUDY/EightQueensAndPuzzle" target="_blank" rel="external">Github完整代码及测试结果</a></p>
<blockquote><p>参考资料<br><a href="http://www.amazon.com/gp/product/0136042597/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0136042597&amp;linkCode=as2&amp;tag=letada-20" target="_blank" rel="external">《人工智能：一种现代的方法》</a><br><a href="http://letstalkdata.com/2013/12/n-queens-part-1-steepest-hill-climbing/" target="_blank" rel="external">N-Queens</a><br><a href="http://www.cnblogs.com/laiy/p/awesome_search.html" target="_blank" rel="external">爬山法、随机重启爬山法、模拟退火算法对八皇后问题和八数码问题的性能测试</a></p>
</blockquote>
<h2 id="八皇后问题"><a href="#八皇后问题" class="headerlink" title="八皇后问题"></a>八皇后问题</h2><p><img src="/images/8q_solved.png" alt=""></p>
<h3 id="符号说明及实例生成和调用"><a href="#符号说明及实例生成和调用" class="headerlink" title="符号说明及实例生成和调用"></a>符号说明及实例生成和调用</h3><p>上图的表示方法为：<code>board[5,0,4,2,8,2,7,3]</code></p>
<p>随机生成一千个实例写入文件</p>
<figure class="highlight python"><figcaption><span>testCaseGenerator.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> random</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    f = open(<span class="string">"eightQueensTest.txt"</span>, <span class="string">"wb"</span>)</div><div class="line">    testCaseCount = <span class="number">1000</span></div><div class="line">    board = <span class="string">""</span></div><div class="line">    <span class="keyword">while</span> testCaseCount &gt; <span class="number">0</span>:</div><div class="line">        testCaseCount -= <span class="number">1</span></div><div class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">7</span>):</div><div class="line">            board += str(random.randint(<span class="number">0</span>,<span class="number">7</span>)) + <span class="string">' '</span></div><div class="line">        board += str(random.randint(<span class="number">0</span>,<span class="number">7</span>)) + <span class="string">'\n'</span></div><div class="line">    f.write(board)</div><div class="line">    f.close()</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p>在每种方法的主函数中读文件获得实例并调用方法求解问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span> open(<span class="string">"eightQueensTest.txt"</span>, <span class="string">"r"</span>) <span class="keyword">as</span> ins:</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> ins:</div><div class="line">        <span class="keyword">print</span> <span class="string">"case: "</span>, totalCase</div><div class="line">        <span class="keyword">global</span> FAILED</div><div class="line">        FAILED = <span class="keyword">False</span></div><div class="line">        totalCase += <span class="number">1</span></div><div class="line">        board = []</div><div class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> line.split():</div><div class="line">            board.append(int(col))</div><div class="line">        board = solution_FirstChoiceHillClimbing(board) <span class="comment"># 换成对应的方法</span></div><div class="line">        <span class="keyword">if</span> FAILED:</div><div class="line">            result += <span class="string">"Failed!"</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            successCase += <span class="number">1</span></div><div class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> range(len(board)):</div><div class="line">                result += str(board[col]) + <span class="string">" "</span></div><div class="line">        result += <span class="string">"\n"</span></div></pre></td></tr></table></figure>
<h3 id="启发式代价"><a href="#启发式代价" class="headerlink" title="启发式代价"></a>启发式代价</h3><p>用互相攻击的皇后数表示<br><img src="/images/5q_example.png" alt=""><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># heuristic cost</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getCollisionNum</span><span class="params">(board)</span>:</span></div><div class="line">    num = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> range(len(board)):</div><div class="line">        <span class="keyword">for</span> anotherCol <span class="keyword">in</span> range(col+<span class="number">1</span>, len(board)):</div><div class="line">            <span class="keyword">if</span> board[col] == board[anotherCol]:</div><div class="line">                num += <span class="number">1</span> <span class="comment"># collied in the same row</span></div><div class="line">            <span class="keyword">elif</span> abs(board[col] - board[anotherCol]) == (anotherCol - col):</div><div class="line">                num += <span class="number">1</span> <span class="comment"># collied diagonally</span></div><div class="line">    <span class="keyword">return</span> num</div></pre></td></tr></table></figure></p>
<h3 id="四种方法的单步操作"><a href="#四种方法的单步操作" class="headerlink" title="四种方法的单步操作"></a>四种方法的单步操作</h3><h4 id="最陡上升爬山法"><a href="#最陡上升爬山法" class="headerlink" title="最陡上升爬山法"></a>最陡上升爬山法</h4><p>计算当前棋盘所有空位置（该列的皇后挪动到该行）的启发式代价（互相攻击皇后数），选择代价最低的。</p>
<p>例如下图中将第二列的皇后放置到第二行冲突数最小，为2。<br><img src="/images/5q_example_numbered.png" alt=""><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># for each column, calculate the collision number</span></div><div class="line"><span class="comment"># if the queen is moved to the other rows</span></div><div class="line"><span class="comment"># find the smallest one and move to it.</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">step_steepestHillClimbing</span><span class="params">(board)</span>:</span></div><div class="line">    collisionNumBoard = &#123;&#125;</div><div class="line">    smallestCollisionNum = getCollisionNum(board)</div><div class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> range(len(board)):</div><div class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(len(board)):</div><div class="line">            <span class="keyword">if</span> board[col] == row:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">            originRow = board[col]</div><div class="line">            board[col] = row</div><div class="line">            collisionNumBoard[(row,col)] = getCollisionNum(board)</div><div class="line">            board[col] = originRow</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">for</span> point,value <span class="keyword">in</span> collisionNumBoard.iteritems():</div><div class="line">        <span class="keyword">if</span> value &lt; smallestCollisionNum:</div><div class="line">            smallestCollisionNum = value</div><div class="line">    </div><div class="line">    smallestCollisionPoints = []</div><div class="line">    <span class="keyword">for</span> point,value <span class="keyword">in</span> collisionNumBoard.iteritems():</div><div class="line">        <span class="keyword">if</span> value == smallestCollisionNum:</div><div class="line">            smallestCollisionPoints.append(point)</div><div class="line">    </div><div class="line">    <span class="comment"># can not find a steeper move</span></div><div class="line">    <span class="comment"># we have come to the peek(local optimization)</span></div><div class="line">    <span class="keyword">if</span> len(smallestCollisionPoints) == <span class="number">0</span>:</div><div class="line">        <span class="comment">#print "local optimization"</span></div><div class="line">        <span class="keyword">global</span> FAILED</div><div class="line">        FAILED = <span class="keyword">True</span></div><div class="line">        <span class="keyword">return</span> board</div><div class="line">    </div><div class="line">    random.shuffle(smallestCollisionPoints)</div><div class="line">    board[smallestCollisionPoints[<span class="number">0</span>][<span class="number">1</span>]]=smallestCollisionPoints[<span class="number">0</span>][<span class="number">0</span>]</div><div class="line">    <span class="keyword">return</span> board</div></pre></td></tr></table></figure></p>
<h4 id="首选爬山法"><a href="#首选爬山法" class="headerlink" title="首选爬山法"></a>首选爬山法</h4><p>随机选择一个空位置，若该位置优于当前棋盘，则选择之。<br>注意，此处“优于”指“冲突数小于等于”，因为经测试，接受冲突数和当前棋盘一样的情况，可大大提高求解率。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># randomly select a point until it is </span></div><div class="line"><span class="comment"># better than the original one</span></div><div class="line"><span class="comment"># change "better than" to "not worse than"</span></div><div class="line"><span class="comment"># can significantly increase the success rate</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">step_FirstChoiceHillClimbing</span><span class="params">(board)</span>:</span></div><div class="line">    collisionNum = getCollisionNum(board)</div><div class="line">    maxRound = <span class="number">1000</span></div><div class="line">    count = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        count += <span class="number">1</span></div><div class="line">        <span class="keyword">if</span>(count &gt;= maxRound):</div><div class="line">            <span class="keyword">global</span> FAILED</div><div class="line">            FAILED = <span class="keyword">True</span></div><div class="line">            <span class="keyword">return</span> board</div><div class="line">        randomRow = random.randint(<span class="number">0</span>,len(board)<span class="number">-1</span>)</div><div class="line">        randomCol = random.randint(<span class="number">0</span>,len(board)<span class="number">-1</span>)</div><div class="line">        <span class="keyword">if</span> board[randomCol] == randomRow:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">        originRow = board[randomCol]</div><div class="line">        board[randomCol] = randomRow</div><div class="line">        <span class="keyword">if</span> getCollisionNum(board) &lt;= collisionNum: <span class="comment"># not worse than</span></div><div class="line">            <span class="keyword">return</span> board</div><div class="line">        board[randomCol] = originRow</div></pre></td></tr></table></figure></p>
<h4 id="随机重启爬山法"><a href="#随机重启爬山法" class="headerlink" title="随机重启爬山法"></a>随机重启爬山法</h4><p>随机选择一个空位置。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">step_RandomHillClimbing</span><span class="params">(board)</span>:</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        randomRow = random.randint(<span class="number">0</span>,len(board)<span class="number">-1</span>)</div><div class="line">        randomCol = random.randint(<span class="number">0</span>,len(board)<span class="number">-1</span>)</div><div class="line">        <span class="keyword">if</span> board[randomCol] != randomRow:</div><div class="line">            board[randomCol] = randomRow</div><div class="line">            <span class="keyword">return</span> board</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> board</div></pre></td></tr></table></figure></p>
<h4 id="模拟退火算法"><a href="#模拟退火算法" class="headerlink" title="模拟退火算法"></a>模拟退火算法</h4><p>结合了爬山法，随机选一个空位置，若冲突数更小，则移动到那里。反之，以一定概率接受更差的选择，避免高不成低不就。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># accept the random choice with certain probability</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">step_SimulatedAnnealing</span><span class="params">(board)</span>:</span></div><div class="line">    temperature = len(board)**<span class="number">2</span></div><div class="line">    annealingRate = <span class="number">0.95</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        randomRow = random.randint(<span class="number">0</span>,len(board)<span class="number">-1</span>)</div><div class="line">        randomCol = random.randint(<span class="number">0</span>,len(board)<span class="number">-1</span>)</div><div class="line">        originCollisionNum = getCollisionNum(board)</div><div class="line">        originRow = board[randomCol]</div><div class="line">        board[randomCol] = randomRow</div><div class="line">        newCollisionNum = getCollisionNum(board)</div><div class="line">        temperature = max(temperature * annealingRate, <span class="number">0.02</span>)</div><div class="line">        <span class="keyword">if</span> newCollisionNum &lt; originCollisionNum:</div><div class="line">            <span class="keyword">return</span> board</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            deltaE = newCollisionNum - originCollisionNum</div><div class="line">            acceptProbability = min(math.exp(deltaE / temperature), <span class="number">1</span>)</div><div class="line">            <span class="keyword">if</span> random.random() &lt;= acceptProbability:</div><div class="line">                <span class="keyword">return</span> board</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                board[randomCol] = originRow</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> board</div></pre></td></tr></table></figure>
<h3 id="结果对比"><a href="#结果对比" class="headerlink" title="结果对比"></a>结果对比</h3><p>每种方法写<code>solution</code>函数一定次数内循环调用<code>step</code>函数, 例如<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">solution_FirstChoiceHillClimbing</span><span class="params">(board)</span>:</span></div><div class="line">    maxRound = <span class="number">200</span> <span class="comment"># the expected number to find a solution</span></div><div class="line">    count = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        collisionNum = getCollisionNum(board)</div><div class="line">        <span class="keyword">if</span> collisionNum == <span class="number">0</span>:</div><div class="line">            <span class="keyword">return</span> board</div><div class="line">        board = step_FirstChoiceHillClimbing(board)</div><div class="line">        <span class="keyword">global</span> FAILED</div><div class="line">        <span class="keyword">if</span> FAILED:</div><div class="line">            <span class="keyword">return</span> board</div><div class="line">        count += <span class="number">1</span></div><div class="line">        <span class="keyword">if</span>(count &gt;= maxRound):</div><div class="line">            FAILED = <span class="keyword">True</span></div><div class="line">            <span class="keyword">return</span> board</div></pre></td></tr></table></figure><br><strong>注意</strong>，每种方法的预期能找到解或失败的循环次数和方法相关。例如最陡上升爬山法有找到解和达到局部最优解或平原地带而陷入循环两种状态。通过测试，200步是合理的预期步数。而模拟退火算法经测试通常在万步级（几万/几十万步）找到解，具体来说是500000步内，不排除超出的情况，处于时间考虑，将超出50万步的视为失败。</p>
<p>对一千个随机生成的样例进行测试并对比<br><img src="/images/8q_time.png" alt=""><br><img src="/images/8q_solvedrate.png" alt=""></p>
<p>数据显示，四种方法对于八皇后问题的解决率都在90%以上，差距不明显。首选爬山法相对较优，模拟退火算法相对较劣。而时间上差距悬殊，最陡上升爬山法和首选爬山法用时极少，随机重启爬山法和模拟退火算法用时极多。相对快的首选爬山法比相对慢的模拟退火算法快了约六百倍。综合来看，首选爬山法最优，最陡上升爬山法稍次之，另两种方法在时间上可以淘汰了。</p>
<h2 id="八数码问题"><a href="#八数码问题" class="headerlink" title="八数码问题"></a>八数码问题</h2><p><img src="/images/8d_solved.png" alt=""></p>
<h3 id="符号说明及实例生成和调用-1"><a href="#符号说明及实例生成和调用-1" class="headerlink" title="符号说明及实例生成和调用"></a>符号说明及实例生成和调用</h3><p>上图是目标状态，0表示空白方块，其他数字可以移动到该位置。代码中用<code>board[0,1,2,3,4,5,6,7,8]</code>来表示</p>
<p>随机生成一千个实例写入文件</p>
<p>从目标状态开始，随机移动空白块一定次数（如5000次）生成实例来确保有解</p>
<figure class="highlight python"><figcaption><span>testCaseGenerator.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> random</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">step_RandomHillClimbing</span><span class="params">(board)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</div><div class="line">        <span class="keyword">if</span> board[i] == <span class="number">0</span>:</div><div class="line">            <span class="keyword">break</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        randCase = random.randint(<span class="number">0</span>,<span class="number">4</span>)</div><div class="line">        <span class="keyword">if</span> randCase == <span class="number">0</span>:</div><div class="line">            <span class="keyword">if</span> i &gt;= <span class="number">3</span>:</div><div class="line">                upBoard = list(board)</div><div class="line">                upBoard[i] = board[i<span class="number">-3</span>]</div><div class="line">                upBoard[i<span class="number">-3</span>] = <span class="number">0</span></div><div class="line">                <span class="keyword">return</span> upBoard</div><div class="line">        <span class="keyword">elif</span> randCase == <span class="number">1</span>:</div><div class="line">            <span class="keyword">if</span> i &lt; <span class="number">6</span>:</div><div class="line">                downBoard = list(board)</div><div class="line">                downBoard[i] = board[i+<span class="number">3</span>]</div><div class="line">                downBoard[i+<span class="number">3</span>] = <span class="number">0</span></div><div class="line">                <span class="keyword">return</span> downBoard</div><div class="line">        <span class="keyword">elif</span> randCase == <span class="number">2</span>:</div><div class="line">            <span class="keyword">if</span> i%<span class="number">3</span> != <span class="number">0</span>:</div><div class="line">                leftBoard = list(board)</div><div class="line">                leftBoard[i] = board[i<span class="number">-1</span>]</div><div class="line">                leftBoard[i<span class="number">-1</span>] = <span class="number">0</span></div><div class="line">                <span class="keyword">return</span> leftBoard</div><div class="line">        <span class="keyword">else</span>:    </div><div class="line">            <span class="keyword">if</span> (i+<span class="number">1</span>)%<span class="number">3</span> != <span class="number">0</span>:</div><div class="line">                rightBoard = list(board)</div><div class="line">                rightBoard[i] = board[i+<span class="number">1</span>]</div><div class="line">                rightBoard[i+<span class="number">1</span>] = <span class="number">0</span></div><div class="line">                <span class="keyword">return</span> rightBoard</div><div class="line">        </div><div class="line">    <span class="keyword">return</span> board</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">solution_RandomHillClimbing</span><span class="params">(board)</span>:</span></div><div class="line">    maxStep = <span class="number">5000</span></div><div class="line">    count = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        board = step_RandomHillClimbing(board)</div><div class="line">        count += <span class="number">1</span></div><div class="line">        <span class="keyword">if</span>(count &gt;= maxStep):</div><div class="line">            <span class="keyword">return</span> board</div><div class="line">    </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    f = open(<span class="string">"eightPuzzleTest.txt"</span>, <span class="string">"wb"</span>)</div><div class="line">    testCaseCount = <span class="number">1000</span></div><div class="line">    result = <span class="string">""</span></div><div class="line">    <span class="keyword">while</span> testCaseCount &gt; <span class="number">0</span>:</div><div class="line">        board = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>]</div><div class="line">        testCaseCount -= <span class="number">1</span></div><div class="line">        </div><div class="line">        board = solution_RandomHillClimbing(board)</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">8</span>): <span class="comment"># i = 0 1 2 3 4 5 6 7</span></div><div class="line">            result += str(board[i]) + <span class="string">' '</span></div><div class="line">        result += str(board[i+<span class="number">1</span>]) + <span class="string">'\n'</span> <span class="comment">#! i+1=8</span></div><div class="line">    <span class="keyword">print</span> result</div><div class="line">    f.write(result)</div><div class="line">    f.close()</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p>在每种方法的主函数中读文件获得实例并调用方法求解问题（和八皇后问题类似，不再赘述）</p>
<h3 id="启发式代价-1"><a href="#启发式代价-1" class="headerlink" title="启发式代价"></a>启发式代价</h3><p>每个数码到目标位置的曼哈顿距离之和，为0时找到解<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># heuristic cost</span></div><div class="line"><span class="comment"># manhattan_distance</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getManhattanDistance</span><span class="params">(board)</span>:</span></div><div class="line">    distance = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</div><div class="line">        distance += abs(i/<span class="number">3</span> - board[i]/<span class="number">3</span>) + abs(i%<span class="number">3</span> - board[i]%<span class="number">3</span>)</div><div class="line">    <span class="keyword">return</span> distance</div></pre></td></tr></table></figure></p>
<h3 id="四种方法的单步操作-1"><a href="#四种方法的单步操作-1" class="headerlink" title="四种方法的单步操作"></a>四种方法的单步操作</h3><p>方法同八皇后，欲知详情，<a href="https://github.com/HYPJUDY/EightQueensAndPuzzle" target="_blank" rel="external">点我</a>。</p>
<h3 id="结果对比-1"><a href="#结果对比-1" class="headerlink" title="结果对比"></a>结果对比</h3><p>同八皇后问题，每种方法写<code>solution</code>函数一定次数内循环调用<code>step</code>函数</p>
<p>对一千个随机生成的样例进行测试并对比<br><img src="/images/8d_time.png" alt=""><br><img src="/images/8d_solvedrate.png" alt=""></p>
<p>从跑的结果来看，时间上和八皇后问题态势接近，解决率却大相径庭。随机重启爬山法和模拟退火算法的解决率不到百分之五十，原来高高在上的最陡上升爬山法和首选爬山法这次的解决率不忍直视。</p>
<p>这是为什么呢？</p>
<p>八皇后问题一个棋盘有<code>8*8-8=56</code>个随机选择，八皇后问题在不考虑旋转与翻转等价时,共有92 个不同的解，考虑时解更多，因此比当前棋盘更优的选择不会少。每次都能减少一点冲突，很快就太平了。</p>
<p>八数码问题一个棋盘的随机选择数在2到4之间，比当前棋盘更优的选择寥寥。经试验，大量棋盘会卡在局部最优解（局部顶峰/平原）而被判失败。意思是空白块左看右看上看下看都没有更好的选择了，但就是不走更差的那条路，那就…堵着吧。</p>
<p>总的来说，最陡上升爬山法傲娇，首选爬山法贪婪，随机重启爬山法盲目，模拟退火算法谨慎又大胆。（以上词不分褒贬）</p>
<p>以上写得非常简略，感觉有一千句话只写了一句，见谅T T。博主要受使命召唤去打怪了！</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/08/15/hello-world/" rel="next" title="Hello World">
                <i class="fa fa-chevron-left"></i> Hello World
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/02/04/tips-about-blog/" rel="prev" title="[Tips] About Blog">
                [Tips] About Blog <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="HYPJUDY" />
          <p class="site-author-name" itemprop="name">HYPJUDY</p>
           
              <p class="site-description motion-element" itemprop="description">What I cannot create, I do not understand.</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/hypjudy" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#问题描述"><span class="nav-number">1.</span> <span class="nav-text">问题描述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#八皇后问题"><span class="nav-number">1.1.</span> <span class="nav-text">八皇后问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#符号说明及实例生成和调用"><span class="nav-number">1.1.1.</span> <span class="nav-text">符号说明及实例生成和调用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启发式代价"><span class="nav-number">1.1.2.</span> <span class="nav-text">启发式代价</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四种方法的单步操作"><span class="nav-number">1.1.3.</span> <span class="nav-text">四种方法的单步操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#最陡上升爬山法"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">最陡上升爬山法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#首选爬山法"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">首选爬山法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#随机重启爬山法"><span class="nav-number">1.1.3.3.</span> <span class="nav-text">随机重启爬山法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#模拟退火算法"><span class="nav-number">1.1.3.4.</span> <span class="nav-text">模拟退火算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#结果对比"><span class="nav-number">1.1.4.</span> <span class="nav-text">结果对比</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#八数码问题"><span class="nav-number">1.2.</span> <span class="nav-text">八数码问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#符号说明及实例生成和调用-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">符号说明及实例生成和调用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启发式代价-1"><span class="nav-number">1.2.2.</span> <span class="nav-text">启发式代价</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四种方法的单步操作-1"><span class="nav-number">1.2.3.</span> <span class="nav-text">四种方法的单步操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#结果对比-1"><span class="nav-number">1.2.4.</span> <span class="nav-text">结果对比</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">HYPJUDY</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'hypjudy';
      var disqus_identifier = '2016/10/06/eight-puzzle-and-eight-queens/';

      var disqus_title = "八皇后和八数码问题";


      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
            this.page.title = disqus_title;
        };
        run_disqus_script('embed.js');
      

    </script>
  










  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  


  

</body>
</html>
